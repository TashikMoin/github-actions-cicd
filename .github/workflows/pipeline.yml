name: Java Spring CICD

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-java-spring:

    runs-on: ubuntu-latest 
    # using ubuntu-latest because docker is pre installed.
    
    steps:
    - uses: actions/checkout@v2

    - name: Checkout
      run: |
      git clone https://${{secrets.USERNAME}}:${{secrets.SECRET}}@github.com/${{secrets.USERNAME}}/${{secrets.REPOSITORY}}.git /app

    - name: Build
      run: |
      docker build -t spring-app --build-arg SECRET=${{secrets.SECRET}} --build-arg USERNAME=${{secrets.USERNAME}} --build-arg REPOSITORY=${{secrets.REPOSITORY}} /app

    - name: Push to ECR
      run: |
      echo "Pushing to ECR"

    - name: Deploy
      run: |
      echo "Deploying to ECR"